{"version":3,"sources":["../src/app.js"],"names":["DBNAME","DBUSER","DBPASS","ENDPOINT","process","env","mongoose","connect","console","log","app","use","body","json","urlencoded","extended","all","req","res","next","header","success","data","options","code","status","message","fail","file","path","join","__dirname","sendFile","userRoute","channelRoute","messageRoute","firebaseRoute"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AACA,MAAM,EAAEA,MAAF,EAAUC,MAAV,EAAkBC,MAAlB,EAA0BC,QAA1B,KAAuCC,QAAQC,GAArD;;AAEAC,mBAASC,OAAT,CACG,aAAYN,MAAO,IAAGC,MAAO,4BAA2BF,MAAO,EADlE,EAEE,MAAM;AACJQ,UAAQC,GAAR,CAAY,gBAAZ;AACD,CAJH;;AAOA,MAAMC,MAAM,wBAAZ;;AAEA;AACAA,IAAIC,GAAJ,CAAQC,qBAAKC,IAAL,EAAR;AACAH,IAAIC,GAAJ,CAAQC,qBAAKE,UAAL,CAAgB,EAAEC,UAAU,KAAZ,EAAhB,CAAR;;AAEAL,IAAIM,GAAJ,CAAQ,IAAR,EAAc,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAChCD,MAAIE,MAAJ,CAAW,6BAAX,EAA0C,GAA1C;AACAF,MAAIE,MAAJ,CAAW,8BAAX,EAA2C,mDAA3C;AACAD;AACD,CAJD;;AAMAT,IAAIC,GAAJ,CAAQ,CAACM,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC1B;AACA,gCAAYF,GAAZ;AACA;AACAC,MAAIG,OAAJ,GAAc,CAACC,IAAD,EAAOC,OAAP,EAAgBC,OAAO,GAAvB,KAA+B;AAC3C,WAAO,OAAOF,IAAP,KAAgB,QAAhB,GACHC,UACEL,IAAIO,MAAJ,CAAWD,IAAX,EAAiBX,IAAjB,CAAsB,EAAES,IAAF,EAAQC,OAAR,EAAtB,CADF,GAEEL,IAAIO,MAAJ,CAAWD,IAAX,EAAiBX,IAAjB,CAAsBS,IAAtB,CAHC,GAIHJ,IAAIO,MAAJ,CAAWD,IAAX,EAAiBX,IAAjB,CAAsB,EAAEa,SAASJ,IAAX,EAAtB,CAJJ;AAKD,GAND;AAOA;AACAJ,MAAIS,IAAJ,GAAW,CAACD,OAAD,EAAUF,OAAO,GAAjB,KAAyB;AAClChB,YAAQC,GAAR,CAAYiB,OAAZ;AACA,WAAOR,IAAIO,MAAJ,CAAWD,IAAX,EAAiBX,IAAjB,CAAsB,EAAEa,OAAF,EAAtB,CAAP;AACD,GAHD;AAIA;;AAEA;AACAP;AACD,CApBD;;AAsBAT,IAAIC,GAAJ,CAAQ,OAAR,EAAiB,CAACM,GAAD,EAAMC,GAAN,KAAc;AAC7B,QAAMU,OAAOC,eAAKC,IAAL,CAAUC,YAAY,uBAAtB,CAAb;AACAb,MAAIc,QAAJ,CAAaJ,IAAb;AACD,CAHD;;AAKAlB,IAAIC,GAAJ,CAAQ,iBAAR,EAA2B,CAACM,GAAD,EAAMC,GAAN,KAAc;AACvC,QAAMU,OAAOC,eAAKC,IAAL,CAAUC,YAAY,gCAAtB,CAAb;AACAb,MAAIc,QAAJ,CAAaJ,IAAb;AACD,CAHD;;AAKAlB,IAAIC,GAAJ,CAAQ,WAAR,EAAqB,CAACM,GAAD,EAAMC,GAAN,KAAc;AACjC,QAAMU,OAAOC,eAAKC,IAAL,CAAUC,YAAY,4BAAtB,CAAb;AACAb,MAAIc,QAAJ,CAAaJ,IAAb;AACD,CAHD;;AAKAlB,IAAIC,GAAJ,CAAS,GAAER,QAAS,QAApB,EAA6B8B,cAA7B;AACAvB,IAAIC,GAAJ,CAAS,GAAER,QAAS,WAApB,EAAgC+B,iBAAhC;AACAxB,IAAIC,GAAJ,CAAS,GAAER,QAAS,WAApB,EAAgCgC,iBAAhC;AACAzB,IAAIC,GAAJ,CAAS,GAAER,QAAS,YAApB,EAAiCiC,kBAAjC;;kBAEe1B,G","file":"app.js","sourcesContent":["import express from 'express';\r\nimport { filterQuery } from './common/filter-query';\r\nimport logger from 'morgan';\r\nimport body from 'body-parser';\r\nimport 'dotenv/config';\r\nimport mongoose from 'mongoose';\r\nimport userRoute from './api/user/user.route';\r\nimport channelRoute from './api/channel/channel.route';\r\nimport messageRoute from './api/message/message.route';\r\nimport path from 'path';\r\nimport firebaseRoute from './api/firebase/firebase.route';\r\nconst { DBNAME, DBUSER, DBPASS, ENDPOINT } = process.env;\r\n\r\nmongoose.connect(\r\n  `mongodb://${DBUSER}:${DBPASS}@ds163850.mlab.com:63850/${DBNAME}`,\r\n  () => {\r\n    console.log('connected mLab');\r\n  }\r\n);\r\n\r\nconst app = express();\r\n\r\n//app.use(logger('dev'));\r\napp.use(body.json());\r\napp.use(body.urlencoded({ extended: false }));\r\n\r\napp.all('/*', (req, res, next) => {\r\n  res.header('Access-Control-Allow-Origin', '*');\r\n  res.header('Access-Control-Allow-Headers', 'Content-Type,accept,access_token,X-Requested-With');\r\n  next();\r\n});\r\n\r\napp.use((req, res, next) => {\r\n  //bind query\r\n  filterQuery(req);\r\n  //for response success\r\n  res.success = (data, options, code = 200) => {\r\n    return typeof data === 'object'\r\n      ? options\r\n        ? res.status(code).json({ data, options })\r\n        : res.status(code).json(data)\r\n      : res.status(code).json({ message: data });\r\n  };\r\n  //for response error\r\n  res.fail = (message, code = 500) => {\r\n    console.log(message);\r\n    return res.status(code).json({ message });\r\n  };\r\n  //for firebase\r\n\r\n  //parse to next\r\n  next();\r\n});\r\n\r\napp.use('/test', (req, res) => {\r\n  const file = path.join(__dirname + '../../html/index.html');\r\n  res.sendFile(file);\r\n});\r\n\r\napp.use('/firebaseWorked', (req, res) => {\r\n  const file = path.join(__dirname + '../../auth/email-password.html');\r\n  res.sendFile(file);\r\n});\r\n\r\napp.use('/firebase', (req, res) => {\r\n  const file = path.join(__dirname + '../../auth2/loginForm.html');\r\n  res.sendFile(file);\r\n});\r\n\r\napp.use(`${ENDPOINT}/users`, userRoute);\r\napp.use(`${ENDPOINT}/channels`, channelRoute);\r\napp.use(`${ENDPOINT}/messages`, messageRoute);\r\napp.use(`${ENDPOINT}/firebases`, firebaseRoute);\r\n\r\nexport default app;\r\n"]}