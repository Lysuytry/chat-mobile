{"version":3,"sources":["../../src/socket.io/socket.js"],"names":["users","chatHandler","socket","on","userId","filter","item","id","push","data","console","log","msg","onlineHandler","name","channel","username","emit","broadcast"],"mappings":";;;;;;;AAAA;;AACA;;AACA,IAAIA,QAAQ,EAAZ;;AAEO,MAAMC,oCAAcC,UAAU;AACnCA,SAAOC,EAAP,CAAU,MAAV,EAAkBC,UAAU;AAC1BJ,YAAQA,MAAMK,MAAN,CAAaC,QAAQA,KAAKC,EAAL,KAAYL,OAAOK,EAAxC,CAAR;AACAP,UAAMQ,IAAN,CAAW,EAAED,IAAIL,OAAOK,EAAb,EAAiBH,QAAQA,MAAzB,EAAX;AACA,2BAAYA,MAAZ,EAAoBF,MAApB;AACD,GAJD;;AAMAA,SAAOC,EAAP,CAAU,MAAV,EAAkBC,UAAU;AAC1BJ,YAAQA,MAAMK,MAAN,CAAaC,QAAQA,KAAKC,EAAL,KAAYL,OAAOK,EAAxC,CAAR;AACA,2BAAYH,MAAZ,EAAoBF,MAApB;AACD,GAHD;;AAKAA,SAAOC,EAAP,CAAU,YAAV,EAAwBM,QAAQ;AAC9BC,YAAQC,GAAR,CAAYF,IAAZ;AACA,gCAAcA,IAAd,EAAoBP,MAApB;AACD,GAHD;;AAKAA,SAAOC,EAAP,CAAU,YAAV,EAAwB,MAAM;AAC5B,2BAAY,EAAZ,EAAgBD,MAAhB;AACAF,YAAQA,MAAMK,MAAN,CAAaC,QAAQA,KAAKC,EAAL,KAAYL,OAAOK,EAAxC,CAAR;AACD,GAHD;;AAKAL,SAAOC,EAAP,CAAU,OAAV,EAAoBS,GAAD,IAAS;AAC1BF,YAAQC,GAAR,CAAYC,GAAZ;AACA,2BAAY,EAAZ,EAAgBV,MAAhB;AACAF,YAAQA,MAAMK,MAAN,CAAaC,QAAQA,KAAKC,EAAL,KAAYL,OAAOK,EAAxC,CAAR;AACD,GAJD;AAKD,CA3BM;;AA6BA,MAAMM,wCAAgBX,UAAU;AACrCA,SAAOC,EAAP,CAAU,MAAV,EAAkBM,QAAQ;AACxB,UAAM,EAAEK,IAAF,EAAQC,OAAR,KAAoBN,IAA1B;AACAT,YAAQA,MAAMK,MAAN,CAAaC,QAAQA,KAAKC,EAAL,KAAYL,OAAOK,EAAxC,CAAR;AACAP,UAAMQ,IAAN,CAAW,EAAED,IAAIL,OAAOK,EAAb,EAAiBS,UAAUF,IAA3B,EAAiCC,OAAjC,EAAX;AACAb,WAAOe,IAAP,CAAY,cAAZ,EAA4BjB,KAA5B;AACAE,WAAOgB,SAAP,CAAiBD,IAAjB,CAAsB,cAAtB,EAAsCjB,KAAtC;AACD,GAND;;AAQAE,SAAOC,EAAP,CAAU,QAAV,EAAoBM,QAAQ;AAC1B,UAAM,EAAEK,IAAF,EAAQC,OAAR,KAAoBN,IAA1B;AACAT,YAAQA,MAAMK,MAAN,CAAaC,QAAQA,KAAKC,EAAL,KAAYL,OAAOK,EAAxC,CAAR;AACAP,UAAMQ,IAAN,CAAW,EAAED,IAAIL,OAAOK,EAAb,EAAiBS,UAAUF,IAA3B,EAAiCC,OAAjC,EAAX;AACAb,WAAOe,IAAP,CAAY,cAAZ,EAA4BjB,KAA5B;AACAE,WAAOgB,SAAP,CAAiBD,IAAjB,CAAsB,cAAtB,EAAsCjB,KAAtC;AACD,GAND;;AAQAE,SAAOC,EAAP,CAAU,YAAV,EAAwB,MAAM;AAC5BH,YAAQA,MAAMK,MAAN,CAAaC,QAAQA,KAAKC,EAAL,KAAYL,OAAOK,EAAxC,CAAR;AACAL,WAAOe,IAAP,CAAY,cAAZ,EAA4BjB,KAA5B;AACAE,WAAOgB,SAAP,CAAiBD,IAAjB,CAAsB,cAAtB,EAAsCjB,KAAtC;AACD,GAJD;AAKD,CAtBM","file":"socket.js","sourcesContent":["import { leftChannel, joinChannel } from '../models/user';\nimport { createMessage } from '../models/message';\nlet users = [];\n\nexport const chatHandler = socket => {\n  socket.on('join', userId => {\n    users = users.filter(item => item.id !== socket.id);\n    users.push({ id: socket.id, userId: userId });\n    joinChannel(userId, socket);\n  });\n\n  socket.on('left', userId => {\n    users = users.filter(item => item.id !== socket.id);\n    leftChannel(userId, socket);\n  });\n\n  socket.on('newMessage', data => {\n    console.log(data);\n    createMessage(data, socket);\n  });\n\n  socket.on('disconnect', () => {\n    leftChannel('', socket);\n    users = users.filter(item => item.id !== socket.id);\n  });\n\n  socket.on('error', (msg) => {\n    console.log(msg);\n    leftChannel('', socket);\n    users = users.filter(item => item.id !== socket.id);\n  });\n};\n\nexport const onlineHandler = socket => {\n  socket.on('join', data => {\n    const { name, channel } = data;\n    users = users.filter(item => item.id !== socket.id);\n    users.push({ id: socket.id, username: name, channel });\n    socket.emit('updateOnline', users);\n    socket.broadcast.emit('updateOnline', users);\n  });\n\n  socket.on('online', data => {\n    const { name, channel } = data;\n    users = users.filter(item => item.id !== socket.id);\n    users.push({ id: socket.id, username: name, channel });\n    socket.emit('updateOnline', users);\n    socket.broadcast.emit('updateOnline', users);\n  });\n\n  socket.on('disconnect', () => {\n    users = users.filter(item => item.id !== socket.id);\n    socket.emit('updateOnline', users);\n    socket.broadcast.emit('updateOnline', users);\n  });\n};\n"]}